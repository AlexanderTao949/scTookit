% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CalculateOR.R
\name{CalculateOR}
\alias{CalculateOR}
\title{Calculate Directional Odds Ratios for Cell Type Enrichment Between Two Groups}
\usage{
CalculateOR(seu, metacol, metacol_values, cellcol)
}
\arguments{
\item{seu}{A \code{\link[Seurat]{Seurat}} object containing single-cell
RNA-seq data and associated metadata.}

\item{metacol}{Character string specifying the metadata column name
containing the grouping variable (e.g., "condition", "treatment", "disease_state").}

\item{metacol_values}{Character vector of length 2 specifying the two groups
to compare. The first element serves as the alternative (positive direction),
and the second as the reference (negative direction) (e.g., \code{metacol_values = c("treat", "control")}).
These values must exist as levels in \code{metacol}.}

\item{cellcol}{Character string specifying the metadata column name
containing cell type identities or cluster annotations (e.g., "cell_type",
"seurat_clusters", "annotation").}
}
\value{
A data.table with columns:
  \itemize{
    \item \strong{celltype}: Factor (ordered by OR), the cell type identifier
    \item \strong{group}: Character, the group showing stronger enrichment
    \item \strong{OR}: Numeric, signed odds ratio where positive values
      indicate enrichment in \code{metacol_values[1]} and negative values
      indicate enrichment in \code{metacol_values[2]}
  }
  Only cell types with finite odds ratios for both groups are retained.
  The data is sorted by OR in descending order.


This signed odds ratio format is particularly useful for generating
diverging bar plots or lollipop charts showing bidirectional enrichment.
}
\description{
Computes cell-wise odds ratios (OR) to quantify enrichment of cell types
across two specified groups/conditions within a Seurat object. For each cell
type, the function determines which group shows stronger association, retains
the higher odds ratio, and assigns a directional sign (positive for the
reference group, negative for the alternative group).
}
\examples{
\dontrun{
  # Calculate directional enrichment between disease and control
  or_results <- CalculateOR(
    seu = seurat_obj,
    metacol = "disease_status",
    metacol_values = c("disease", "control"),
    cellcol = "cell_type"
  )

  # Plot results
  library(ggplot2)
  ggplot(or_results, aes(x = celltype, y = OR, fill = group)) +
    geom_col() +
    coord_flip() +
    labs(y = "Signed Odds Ratio", x = "Cell Type")
}
}
