% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getpseudobulk.R
\name{getpseudobulk}
\alias{getpseudobulk}
\title{Generate Pseudo-bulk Expression Matrix from Seurat Object}
\usage{
getpseudobulk(seu, group_by, cell_col = NULL, cell_choose = NULL)
}
\arguments{
\item{seu}{A Seurat object containing single-cell RNA-seq data.}

\item{group_by}{Character string specifying the metadata column name to group cells by
(e.g., "orig.ident", "sample_id"). This determines the columns of the output matrix.}

\item{cell_col}{Optional character string specifying the metadata column for cell type
annotation (e.g., "cell_type", "major_celltype"). Required when \code{cell_choose} is provided.}

\item{cell_choose}{Optional character string specifying a single cell type to subset
(e.g., "Macrophages", "T_cells"). When provided, \code{cell_col} must also be provided
(cannot be NULL) and \code{cell_choose} must be a single value (length = 1).}
}
\value{
A data frame with genes as rows and samples as columns, containing summed
  pseudo-bulk expression counts.
}
\description{
Aggregates single-cell RNA-seq counts into pseudo-bulk expression profiles by sample.
Optionally filters for a specific cell type before aggregation.
}
\examples{
# Aggregate all cells by sample
pseudo_bulk <- getpseudobulk(seu, group_by = "orig.ident")

# Aggregate only Macrophages by sample (requires cell_col)
pseudo_bulk_mac <- getpseudobulk(
  seu,
  group_by = "orig.ident",
  cell_col = "major_celltype",
  cell_choose = "Macrophages"
)
}
